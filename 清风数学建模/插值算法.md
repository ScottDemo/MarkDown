# 插值算法

数模比赛中，常常需要根据已知的函数点进行数据、模型的处理和分析1，而有时候现有的数据是极少的，不足以支撑分析的进行，这时就需要使用一些数学的方法，“模拟产生”一些新的但又比较靠谱的值来满足需求，这就是插值的作用。

## 1. 一维插值问题

![image-20200720191555982](https://gitee.com/ScottDemo/cloudimg/raw/master/清风数学建模/image-20200720191555982.png)

### 1.1 插值法原理

**定理：**设有n+1个互不相同的节点$(x_i, y_i)(i=0,1,...,n)$，则存在唯一的多项式：
$$
L_n(x) = a_0+a_1x+a_2x^2+...+a_nx^n
$$

使得$L_n(x_j)=y_j(j=0,1,...,n)$

> 1. 只要n+1个节点互异，满足上述插值条件的多项式是唯一存在的。
> 2. 如果不限制多项式的次数，插值多项式并不唯一。

### 1.2 拉格朗日插值法

在若干个不同的地方得到相应的观测值，拉格朗日插值法可以找到一个多项式，其恰好在各个观测点取到观测到的值。
$$
两个点：(x_0, y_0),(x_1, y_1)\\
f(x) = \frac{x-x_1}{x_0-x_1}y_0 + \frac{x-x_0}{x_1-x_0}y_1\\
\\
三个点：(x_0, y_0),(x_1, y_1),(x_2, y_2)\\
f(x) = \frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}y_0 + \frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}y_1 + \frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}y_1\\
$$

#### 1.2.1 龙格现象

高次插值会产生龙格现象，即在两端处波动极大，产生明线震荡。在不熟悉曲线运动趋势的前提下，不要轻易使用高次插值。

#### 1.2.2 分段二次插值

![image-20200720201243890](https://gitee.com/ScottDemo/cloudimg/raw/master/清风数学建模/image-20200720201243890.png)

### 1.3 牛顿插值法

![image-20200720202042627](https://gitee.com/ScottDemo/cloudimg/raw/master/清风数学建模/image-20200720202042627.png)

#### 1.3.1 两种插值法的另一个缺点

拉格朗日插值法和牛顿插值法仅仅要求插值多项式在插值节点处与被插函数有相等的函数值，而这种插值多项式却`不能全面反映被插值函数的性态`

然而在许多实际问题中，不仅要求插值函数与被插值函数在所有节点处有相同的函数值，它也需要在一个或全部节点上插值多项式与被插函数有相同的低阶甚至高阶的导数值。

对于这些情况，拉格朗日插值法和牛顿插值法都不能满足。

### 1.4 埃尔米特（Hermite）插值法

**原理：**

![image-20200720212338950](https://gitee.com/ScottDemo/cloudimg/raw/master/清风数学建模/image-20200720212338950.png)

**分段三次埃尔米特插值**

直接使用Hermite插值得到的多项式次数较高，也存在着龙格现象，因此在实际应用中，往往使用分段三次Hermite插值多项式（PCHIP）。

> Matlab有内置的函数：
>
> p = pchip(x, y, new_x)
>
> x是已知样本点的横坐标；y是已知的样本点的纵坐标；
>
> new_x是要插入处对应的横坐标

### 1.5 三次样条插值

> Matlab有内置的函数：
>
> p = spline(x, y, new_x)
>
> x是已知样本点的横坐标；y是已知的样本点的纵坐标；
>
> new_x是要插入处对应的横坐标

## 2. subplot函数可以在同一图形中显示多幅图像












































